{% extends 'controlpanel/controlpanel_base.html' %}
{% block content %}

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:300px;margin-top:43px;">

  <!-- Header -->
  <header class="w3-container" style="padding-top:22px">
    <h5><b><i class="fa fa-dashboard"></i> Power Tools Control Panel - Tools</b></h5>
  </header>

<div class="w3-container">

{% for tool in tools %}

    <div class="w3-container w3-card w3-white w3-round w3-margin"><br>
        <img src="../../static/icons/tools.png" alt="Avatar" class="w3-left w3-circle w3-margin-right" style="width:60px">        
        <h4>{{ tool.make }}, {{ tool.serialno }}</h4>
        <div class="w3-left w3-opacity">Last rent - {{ tool.last_rentered }}</div><br>
        <hr class="w3-clear">
        <img src="../../static/images/tools.jpeg" style="width:20%" class="w3-margin-bottom">
        <p>{{ tool.desc }}</p>
        <p>{{ tool.rentalvalue }}</p>
        <button type="button" class="w3-button w3-green w3-margin-bottom"><i class="fa fa-exchange"></i>  Rents</button> 
        <button type="button" class="w3-button w3-green w3-margin-bottom" onclick="modalFunction({{ tool.pk }})"><i class="fa fa-edit"></i>  Edit</button> 
        <button type="button" class="w3-button w3-red w3-margin-bottom"><i class="fa fa-remove"></i>  Remove</button> 
      </div>

{% endfor %}

</div> 

<!-- modal for edit -->

  <div id="id01" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-round">
      <header class="w3-container"> 
        <span onclick="document.getElementById('id01').style.display='none'" 
        class="w3-button w3-display-topright w3-round">&times;</span>
        <h2 id="toolname">Modal Header</h2>
      </header>
        <hr class="w3-clear">
        <form class="w3-container" action="{% url 'updatetools' %}" method="post">
            {% csrf_token %}
            {{ editform }}
        
              <footer class="w3-margin-top">
                <button type="submit" class="w3-button w3-green w3-margin-bottom"><i class="fa fa-edit"></i>  Save</button> 
                <button type="button" class="w3-button w3-red w3-margin-bottom" onclick="document.getElementById('id01').style.display='none'" ><i class="fa fa-remove"></i>  Cancel</button> 
              </footer>
        </form>
    </div>
  </div>


</div>
<!-- Footer -->
  <footer class="w3-container w3-padding-16 w3-light-grey">
    <h4>FOOTER</h4>
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
  </footer>

</div>

{% endblock %}

{% block script %}
<script>

var namecontainer = document.getElementById('toolname');

function modalFunction(t) {    
    var editRequest = new XMLHttpRequest();

    editRequest.open('GET', "/controlpanel/edittools/");
    editRequest.onload = function(){
        var editData = JSON.parse(editRequest.responseText);
        renderEdit(editData, t);
    };
    editRequest.send();   
}

function renderEdit(data, t){
    namecontainer.innerHTML = 'Edit ' + data[t-1].make + ", " +data[t-1].serialno;
    
    document.getElementById('sn').value = data[t-1].serialno
    document.getElementById('mk').value = data[t-1].make
    document.getElementById('rv').value = data[t-1].rentalvalue
    document.getElementById('dc').value = data[t-1].desc

    document.getElementById('id01').style.display='block';
}
</script>
{% endblock %}

